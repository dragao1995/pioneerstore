<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" 
	creationComplete="init();"
	width="290" height="400" xmlns:list="view.list.*"
	doubleClick="PopUpManager.removePopUp(this);"
	>
	<mx:Script>
		<![CDATA[
			import mx.containers.Box;
			import event.list.ListClickEnent;
			import mx.controls.Alert;
			import mx.managers.PopUpManager;
			private var tblName:String=null;
			private var condition:String=null;
			private var obj:Object=null;
			
			private var parentbox:Object=null;
			private function init():void{
				//searchrs.addEventListener(ListClickEnent.ROW_CLICK,setObj,false,0,false);
				searchrs.addEventListener(ListClickEnent.rowClick,setObj,false,0,false);
			}
			public function setParentBox(parentbox:Object):void{
				this.parentbox=parentbox;
			}
			
			
			public function setTbl(tblName:String):void{
				this.tblName=tblName;
				searchrs.tbName=this.tblName;
			}
			
			public function setCondition(condition:String):void{
				this.condition=condition;
			}
			
			private function search():void{
				if(null==keyinput.text){
					Alert.show("请输入搜索条件！");
					return;
				}
				var cd:String=null;
				if(null!=this.condition){
					cd=this.condition+" and NAME like'%"+keyinput.text+"%'";
				}else{
					cd="NAME like'%"+keyinput.text+"%'";
				}
				//Alert.show("cd="+cd);
				searchrs.setCondition(cd);
				
			}
			
			private function keysearch(e:KeyboardEvent):void{
				//Alert.show("e.keyCode="+e.keyCode);
				if(e.keyCode==13){
					search();
				}
			}
			
			public function addObj():void{
				if(null==this.obj){
					Alert.show("请选择确认的内容！");
					return;
				}
				try{
					//var box:Object=Object(this.parent);
					if(null==parentbox){
						Alert.show("没有设置调用窗口的对象！");						
					}else{
						parentbox.addObj(this.obj);
						PopUpManager.removePopUp(this);
					}
				}catch(e:Error){
					Alert.show(e.getStackTrace());
				}
				
				
			}
			public function setObj(e:ListClickEnent):void{
				this.obj=e.obj;
			}
		]]>
	</mx:Script>
	<mx:Box width="100%" height="100%">
		<mx:ApplicationControlBar height="50" width="100%" horizontalAlign="center">
			<mx:Label text="名称："/>
			<mx:TextInput width="90" id="keyinput"  keyUp="keysearch(event);"/>
			<mx:Button label="搜索" click="search();"/>
		</mx:ApplicationControlBar>
		<list:ListView id="searchrs" width="100%" height="90%"/>
		<mx:HBox horizontalAlign="center" width="100%">
			<mx:Button label="添加" click="addObj();"/>
			<mx:Button label="关闭" click="PopUpManager.removePopUp(this);"/>
		</mx:HBox>
	</mx:Box>
	
</mx:TitleWindow>
